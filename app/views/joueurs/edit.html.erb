<% content_for :title, "Modifier un joueur" %>

<div>
  <%= link_to "Joueurs >", joueurs_path %>
</div>
<p style="color: green"><%= notice %></p>

<h1>Modifier un joueur</h1>

<div style="display: flex; justify-content: space-between; gap: 20px;">
  <div style="flex: 1; border: 1px solid #ccc; padding: 20px;">
    <h3>Informations personnelles</h3>
    <%= form_with(model: @joueur) do |form| %>
      <div>
        <%= form.submit "Enregistrer", class:"btn btn-primary", style: "float:right" %>
      </div>

      <% if @joueur.errors.any? %>
        <div style="color: red">
          <h2><%= pluralize(@joueur.errors.count, "erreur") %> empêchent ce joueur d'être sauvegardé :</h2>
          <ul>
            <% @joueur.errors.each do |error| %>
              <li><%= error.full_message %></li>
            <% end %>
          </ul>
        </div>
      <% end %>
      <br>
      <div class="mb-3">
        <%= form.label :prénom, style: "display: block" %>
        <%= form.text_field :prénom ,class: "form-control" %>
      </div>

      <div class="mb-3">
        <%= form.label :nom, style: "display: block" %>
        <%= form.text_field :nom ,class: "form-control" %>
      </div>

      <div class="mb-3">
        <%= form.label :sexe, class: "form-label" %><br>

        <div class="form-check form-check-inline ml-3">
          <%= form.radio_button :sexe, "male", class: "form-check-input" %>
          <%= form.label :sexe_male, "Mâle", class: "form-check-label" %>
        </div>

        <div class="form-check form-check-inline">
          <%= form.radio_button :sexe, "femelle", class: "form-check-input" %>
          <%= form.label :sexe_femelle, "Femelle", class: "form-check-label" %>
        </div>

      </div>

      <div class="mb-3">
        <%= form.label :date_naissance, class: "form-label" %>
        <div class="input-group">
          <div class="input-group-prepend">
            <span class="input-group-text" id="basic-addon1" style="background-color:rgba(119, 169, 223, 0.35)">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar2-week" viewBox="0 0 16 16" style="color: #0069d9;">
                <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"/>
                <path d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5zM11 7.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm-3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm-5 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"/>
              </svg>
            </span>
          </div>
          <%= form.text_field :date_naissance, class: "form-control datepicker", placeholder: "Date" %>
        </div>
      </div>

      <div class="mb-3">
        <%= form.label :parent_id, "Parent", style: "display: block" %>
        <%= form.select :parent_id, 
              Parent.all.map { |parent| ["#{parent.prénom} #{parent.nom}", parent.id] }, 
              { prompt: "Choisir un parent existant" }, 
              { class: "custom-select" } %>
      </div>

      <div>
        <%= form.label :note, style: "display: block" %>
        <%= form.text_area :note, class: "form-control" %>
      </div>
    <% end %>
    <hr>
    <%= button_to "Supprimer ce joueur", @joueur, method: :delete, data: { confirm: "Are you sure?" }, class: "btn btn-danger" %>
  </div>
  
<!--******************************PAIEMENTS**********************************-->
  <div style="flex: 1; border: 1px solid #ccc; padding: 20px;">
    <h3>Abonnement</h3>
    <p>
      <button id="btnAjout2" class="btn btn-success">Ajouter un paiement</button>
    </p>

    <div class="hideForm" id="paiementForm">
      <button id="btnAnnuler2" class="btn btn-secondary" style="float:right">Annuler</button>
      <%= form_with(model: @paiement) do |form| %>
        <% if @paiement.errors.any? %>
          <div style="color: red">
            <h2><%= pluralize(@paiement.errors.count, "erreur") %> empêchent ce paiement d'être sauvegardé :</h2>
            <ul>
              <% @paiement.errors.each do |error| %>
                <li><%= error.full_message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>
        <br>

        <div class="mb-3">
          <%= form.check_box :etat_abonnement, { checked: false }, 'Crédit', nil %>
          <%= form.label :etat_abonnement, "Marquer comme Crédit" %>
        </div>

        <div style="display: none">
          <%= form.hidden_field :joueur_id, value: @joueur.id %>
        </div>

        <div class="mb-3">
          <%= form.label :montant, "Paiement (DT)", style: "display: block" %>
          <%= form.number_field :montant, class: "form-control", value: default_payment_value(@joueur,@saison) %>
        </div>

        <div class="mb-3">
          <%= form.label :date_abonnement, "Date d'abonnement", style: "display: block" %>
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text" style="background-color:rgba(119, 169, 223, 0.35)">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar2-week" viewBox="0 0 16 16" style="color: #0069d9;">
                  <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"/>
                  <path d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5zM11 7.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm-3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm-5 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"/>
                </svg>
              </span>
            </div>
            <%= form.text_field :date_abonnement, class: "form-control datepicker", placeholder: "date d'abonnement" %>
          </div>
        </div>

        <div class="mb-3">
          <%= form.label :date_encaissement, "Date d'encaissement", style: "display: block" %>
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text" style="background-color:rgba(119, 169, 223, 0.35)">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar2-week" viewBox="0 0 16 16" style="color: #0069d9;">
                  <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"/>
                  <path d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5zM11 7.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm-3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm-5 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"/>
                </svg>
              </span>
            </div>
            <%= form.text_field :date_encaissement, class: "form-control datepicker", placeholder: "date d'encaissement" %>
          </div>
        </div>

        <div class="mb-3">
          <%= form.label :num_recu, "Numéro de reçu", style: "display: block" %>
          <%= form.number_field :num_recu, class: "form-control" %>
        </div>

        <br>

        <div>
          <%= form.submit "Ajouter", class: "btn btn-primary" %>
        </div>
      <% end %>

    </div>

    <table class="table table-bordered">
      <thead class="thead-light">
        <tr>
          <th>Paiement</th>
          <th>Date d'abonnement</th>
          <th>Date d'encaissement</th>
          <th>Expire</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @joueur.paiements.reverse.each do |paiement| %>
          <tr id="<%= dom_id paiement %>" class="<%= 
            if paiement == paiement.joueur.paiements.last
              if paiement.etat_abonnement == 'Crédit'
                'etat_crédit'
              elsif (paiement.joueur.paiements.last.date_abonnement + 30.days - Date.today).to_i < 0
                'etat_expiré'
              else
                ''
              end
            elsif paiement.etat_abonnement == 'Crédit'
              'etat_crédit'
            else
              'etat_passé'
            end
          %>">
            <td><%= paiement.montant %>&nbspDT</td>
            <td>
              <%= "#{paiement.date_abonnement.strftime('%d')} #{I18n.t('date.month_names_short')[paiement.date_abonnement.month]}, #{paiement.date_abonnement.strftime('%Y')}" if paiement.date_abonnement %>
            </td>
            <td>
              <%= "#{paiement.date_encaissement.strftime('%d')} #{I18n.t('date.month_names_short')[paiement.date_encaissement.month]}, #{paiement.date_encaissement.strftime('%Y')}" if paiement.date_encaissement %>
            </td>
            <td> 
              <% expiration_date = paiement.date_abonnement + 30.days %>
              <%= "#{expiration_date.strftime('%d')} #{I18n.t('date.month_names_short')[expiration_date.month]}, #{expiration_date.strftime('%Y')}" %>
              <br><strong>
                <% if paiement == paiement.joueur.paiements.last %>
                  <% if (expiration_date - Date.today).to_i > 0 %>
                    reste : <%= (expiration_date - Date.today).to_i %> jours
                  <% elsif (expiration_date - Date.today).to_i == 0 %>
                    Aujourd'hui
                  <% else %>
                    </strong>
                    <span style="color:red">(Expiré)</span>
                  <% end %>
                <% end %>
            </td>
            <td>
              <div class="d-flex align-items-center">
                <%= button_to 'Delete', paiement_path(paiement), method: :delete, data: { confirm: 'Êtes-vous sûr ?' }, class: "btn btn-danger btn-sm me-2" %>&nbsp
                <% if paiement.etat_abonnement == 'Crédit' %>
                  <%= form_with(model: paiement, method: :patch, local: true) do |form| %>
                    <%= form.hidden_field :joueur_id, value: paiement.joueur_id %>
                    <%= form.hidden_field :montant, value: paiement.montant %>
                    <%= form.hidden_field :date_abonnement, value: paiement.date_abonnement %>
                    <%= form.hidden_field :date_encaissement, value: paiement.date_encaissement %>
                    <%= form.hidden_field :etat_abonnement, value: 'Non crédit' %>
                    <%= form.submit 'Payer', class: "btn btn-success btn-sm" %>
                  <% end %>
                <% else %>
                  <button class="btn btn-secondary btn-sm" disabled>Payé</button>
                <% end %>
              </div>
            </td>

          </tr>
        <% end %>
      </tbody>
    </table>
<!--************************ASSURANCE*******************************-->
    <hr>
    <h3>Assurance</h3>
    <p>
      <button id="btnAjout3" class="btn btn-success">Ajouter une assurance</button>
    </p>

    <div class="hideForm" id="assuranceForm">
      <button id="btnAnnuler3" class="btn btn-secondary" style="float:right">Annuler</button>
      <%= form_with(model: @assurance) do |form| %>
        <% if @assurance.errors.any? %>
          <div style="color: red">
            <h2><%= pluralize(@assurance.errors.count, "erreur") %> empêchent cette assurance d'être sauvegardée :</h2>
            <ul>
              <% @assurance.errors.each do |error| %>
                <li><%= error.full_message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>
        <br>

        <div class="mb-3">
          <%= form.check_box :etat_paiement, { checked: false }, 'Crédit', nil %>
          <%= form.label :etat_paiement, "Marquer comme Crédit" %>
        </div>
        
        <div style="display: none">
          <%= form.hidden_field :joueur_id, value: @joueur.id %>
        </div>

        <div class="mb-3">
          <%= form.label :saison_id, "Saison", style: "display: block" %>
          <%= form.select :saison_id, 
                Saison.all.map { |saison| 
                  start_date = "#{saison.date_debut.strftime('%d')} #{I18n.t('date.month_names_short')[saison.date_debut.month]} #{saison.date_debut.strftime('%Y')}"
                  end_date = "#{saison.date_fin.strftime('%d')} #{I18n.t('date.month_names_short')[saison.date_fin.month]} #{saison.date_fin.strftime('%Y')}"
                  ["#{start_date} à #{end_date}", saison.id, { "data-montant" => saison.montant_assurance }]
                }, 
                { prompt: "Choisir une saison" }, 
                { class: "custom-select" } %>
        </div>

        <div class="mb-3">
          <%= form.label :montant, "Montant (DT)", class: "form-label" %>
          <%= form.number_field :montant, class: "form-control", id: "montant-field", value: "" %>
        </div>

        <div class="mb-3">
          <%= form.label :date_paiement, "Date de paiement", class: "form-label" %>
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon1" style="background-color:rgba(119, 169, 223, 0.35)">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar2-week" viewBox="0 0 16 16" style="color: #0069d9;">
                  <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"/>
                  <path d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5zM11 7.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm-3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm-5 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"/>
                </svg>
              </span>
            </div>
            <%= form.text_field :date_paiement, class: "form-control datepicker", placeholder: "date de paiement" %>
          </div>
        </div>

        <div>
          <%= form.submit "Ajouter", class: "btn btn-primary" %>
        </div>
      <% end %>

    </div>

    <table class="table table-bordered">
      <thead class="thead-light">
        <tr>
          <th>Paiement</th>
          <th>Date de paiement</th>
          <th>Saison</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @joueur.assurances.reverse.each do |assurance| %>
          <tr id="<%= dom_id assurance %>" class="<%= 'etat_crédit' if assurance.etat_paiement == 'Crédit' %>">
            <td><%= assurance.montant%>&nbspDT</td>
            <td><%= assurance.date_paiement.strftime("%d #{I18n.t('date.month_names_short')[assurance.date_paiement.month]}, %Y") if assurance.date_paiement %></td>
            <td><%= "#{assurance.saison.date_debut.strftime('%d')} #{I18n.t('date.month_names_short')[assurance.saison.date_debut.month]} #{assurance.saison.date_debut.strftime('%Y')} à #{assurance.saison.date_fin.strftime('%d')} #{I18n.t('date.month_names_short')[assurance.saison.date_fin.month]} #{assurance.saison.date_fin.strftime('%Y')}" %></td>

            <td>
              <div class="d-flex align-items-center">
                <%= button_to 'Delete', assurance_path(assurance), method: :delete, data: { confirm: 'Êtes-vous sûr ?' }, class: "btn btn-danger btn-sm me-2" %>&nbsp
                <% if assurance.etat_paiement == 'Crédit' %>
                  <%= form_with(model: assurance, method: :patch, local: true) do |form| %>
                    <%= form.hidden_field :joueur_id, value: assurance.joueur_id %>
                    <%= form.hidden_field :saison_id, value: assurance.saison_id %>
                    <%= form.hidden_field :montant, value: assurance.montant %>
                    <%= form.hidden_field :date_paiement, value: assurance.date_paiement %>
                    <%= form.hidden_field :etat_paiement, value: 'Non crédit' %>
                    <%= form.submit 'Payer', class: "btn btn-success btn-sm" %>
                  <% end %>
                <% else %>
                  <button class="btn btn-secondary btn-sm" disabled>Payé</button>
                <% end %>
              </div>
            </td>

          </tr>
        <% end %>
      </tbody>
    </table>

<!--************************ACHATS*******************************-->
    <hr>
    <h3>Achats</h3>
    <p>
      <button id="btnAjout4" class="btn btn-success">Ajouter un achat</button>
    </p>

    <div class="hideForm" id="achatForm">
      <button id="btnAnnuler4" class="btn btn-secondary" style="float:right">Annuler</button>
      <%= form_with(model: @achat) do |form| %>
        <% if @achat.errors.any? %>
          <div style="color: red">
            <h2><%= pluralize(@achat.errors.count, "erreur") %> empêchent cet achat d'être sauvegardé :</h2>
            <ul>
              <% @achat.errors.each do |error| %>
                <li><%= error.full_message %></li>
              <% end %>
            </ul>
          </div>
        <% end %>
        <br>

        <div class="mb-3">
          <%= form.check_box :etat_paiement, { checked: false }, 'Crédit', nil %>
          <%= form.label :etat_paiement, "Marquer comme Crédit" %>
        </div>
        
        <div style="display: none">
          <%= form.hidden_field :joueur_id, value: @joueur.id %>
        </div>

        <div class="mb-3">
          <%= form.label :designation, "Désignation", class: "form-label" %>
          <%= form.text_field :designation, class: "form-control" %>
        </div>

        <div class="mb-3">
          <%= form.label :prix, "Prix", class: "form-label" %>
          <%= form.number_field :prix, class: "form-control", step: 0.01 %>
        </div>

        <div class="mb-3">
          <%= form.label :date_achat, "Date d'achat", class: "form-label" %>
          <div class="input-group">
            <div class="input-group-prepend">
              <span class="input-group-text" id="basic-addon2" style="background-color:rgba(119, 169, 223, 0.35)">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-calendar2-week" viewBox="0 0 16 16" style="color: #0069d9;">
                  <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"/>
                  <path d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5zM11 7.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm-3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm-5 3a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5zm3 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5z"/>
                </svg>
              </span>
            </div>
            <%= form.text_field :date_achat, class: "form-control datepicker", placeholder: "date d'achat" %>
          </div>
        </div>

        <div>
          <%= form.submit "Ajouter", class: "btn btn-primary" %>
        </div>
      <% end %>

    </div>

    <table class="table table-bordered">
      <thead class="thead-light">
        <tr>
          <th>Prix</th>
          <th>Date d'achat</th>
          <th>Désignation</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <% @joueur.achats.reverse.each do |achat| %>
          <tr id="<%= dom_id achat %>" class="<%= 'etat_crédit' if achat.etat_paiement == 'Crédit' %>">
            <td><%= achat.prix %>&nbspDT</td>
            <td><%= achat.date_achat.strftime("%d #{I18n.t('date.month_names_short')[achat.date_achat.month]}, %Y") if achat.date_achat %></td>
            <td><%= achat.designation %></td>
            <td>
              <div class="d-flex align-items-center">
                <%= button_to 'Delete', achat_path(achat), method: :delete, data: { confirm: 'Êtes-vous sûr ?' }, class: "btn btn-danger btn-sm me-2" %>&nbsp
                <% if achat.etat_paiement == 'Crédit' %>
                  <%= form_with(model: achat, method: :patch, local: true) do |form| %>
                    <%= form.hidden_field :joueur_id, value: achat.joueur_id %>
                    <%= form.hidden_field :designation, value: achat.designation %>
                    <%= form.hidden_field :prix, value: achat.prix %>
                    <%= form.hidden_field :date_achat, value: achat.date_achat %>
                    <%= form.hidden_field :etat_paiement, value: 'Non crédit' %>
                    <%= form.submit 'Payer', class: "btn btn-success btn-sm" %>
                  <% end %>
                  <% else %>
                  <button class="btn btn-secondary btn-sm" disabled>Payé</button>
                <% end %>
              </div>
            </td>

          </tr>
        <% end %>
      </tbody>
    </table>

  </div>

</div>